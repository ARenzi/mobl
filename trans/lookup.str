module lookup

imports
  include/MoBL
  check
  declare

strategies

  lookup-type =
       lookup-type-aux
    <+ 
      ?SimpleType(QId(qid, _))
      ; where(<lookup-import-module; alltd(declare)> Import(qid))
      ; lookup-type-aux
    
  lookup-type-aux :
    SimpleType(qid) -> <GetEntity> qid
  
  lookup-type-aux :
    SimpleType(qid) -> <GetType> qid
    
  lookup-type-aux :
    GenericType(qid, t*) -> <GetGenericType> (qid, <length> t*)
  
  lookup-template =
       lookup-template-aux
    <+ 
      ?(QId(qid, _), arg-type*)
      ; where(<lookup-import-module; alltd(declare)> Import(qid))
      ; lookup-template-aux

  lookup-template-aux :
    (qid, arg-type*) -> <GetTemplate>
    
  get-all-types =
    <concat> [<all-keys-GetEntity>, <all-keys-GetType>, <map(Fst)> <all-keys-GetGenericType>]